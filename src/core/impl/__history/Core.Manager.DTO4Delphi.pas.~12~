unit Core.Manager.DTO4Delphi;

interface

uses Core.Contracts.DTO4Delphi;

type

  TCoreManagerDTO4Delphi<T: IInterface> = class(TInterfacedObject,
    ICoreDTO4Delphi<T>)
  private
    FInstance: T;
    FParams: ICoreParams4DTODelphi<T>;
  public
    constructor Create;
    destructor Destroy; override;
    class function New: ICoreDTO4Delphi<T>;
    function Bind: ICoreDTO4Delphi<T>;
    function DTO: T;
    function Params: ICoreParams4DTODelphi<T>;
  end;

implementation

{ TCoreManagerDTO4Delphi<T> }

uses RTTI.Manager.DTO4Delphi, Core.Params.Manager.DTO4Delphi;

function TCoreManagerDTO4Delphi<T>.Bind: ICoreDTO4Delphi<T>;
begin
  Result := Self;
end;

constructor TCoreManagerDTO4Delphi<T>.Create;
begin
  FInstance := TRTTIManager4DTODelphi<T>.New(Self).AsInstace;
end;

destructor TCoreManagerDTO4Delphi<T>.Destroy;
begin

  inherited;
end;

function TCoreManagerDTO4Delphi<T>.DTO: T;
begin
  Result := FInstance;
end;

class function TCoreManagerDTO4Delphi<T>.New: ICoreDTO4Delphi<T>;
begin
  Result := Self.Create;
end;

function TCoreManagerDTO4Delphi<T>.Params: ICoreParams4DTODelphi<T>;
begin
  if FParams = nil then
    FParams := TCoreParamsDTO4Delphi<T>.New(Self);
  Result := FParams;
end;

end.
